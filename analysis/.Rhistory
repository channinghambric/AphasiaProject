check_data %>% filter(typeoftrial=="comprehension") %>% count()
#Should be 24 comprehension q's per sub
check_data %>% filter(typeoftrial=="comprehension") %>% group_by(subject) %>%count()
#Should be 12 yes and 12 no comp q's per subject
check_data %>% filter(typeoftrial=="comprehension") %>% group_by(subject,comprehension_type) %>%count()
demo = base %>% filter(typeoftrial %in% c("demo","english","notenglish"))
View(demo$race)
View(base)
View(demo)
#Data from second pilot - N=8
check_data <-read_csv("../data/object-state-sentence-focus_checking2.csv")
base<-check_data
check_data_clean <- check_data %>%
filter(!is.na(subject))
length(check_data_clean %>% pull(subject) %>% unique())
#Should be 8 participants
prac_data <- check_data %>%
filter(trialcondition %in% c("practice_s","practice_n")) %>% filter(correct!="NA")
#Each participant should get 4 practice, 2 with yes (true) as the correct answer and 2 with no (False)
prac_data %>% group_by(subject,trialcondition) %>% count()
#Practice sentences should have 2 framed as targets ("came into contact with"), 2 framed as filler ("x is on a x")
prac_data %>% select(sentence) %>% unique()
exp_data <- check_data %>%
filter(typeoftrial=="picture" & !(trialcondition %in% c("filler", "practice_s","practice_n"))) %>%
separate(trialcondition, into = c("weight", "state","focus"))
#There should be 320 trials total (8 sub x 40)
exp_data %>% count()
#There should be 40 trials per participant
exp_data %>% group_by(subject) %>% count()
#Each participant should have 20 trials in each weight condition
exp_data %>% group_by(subject, weight) %>% count()
#Each participant should have 20 trials in each state condition
exp_data %>% group_by(subject, state) %>% count()
#Each participant should have 20 trials in each focus condition
exp_data %>% group_by(subject, focus) %>% count()
#Each participant should have 5 trials in each of 8 weight x state x focus conditions
exp_data %>% group_by(subject, weight, state, focus) %>% count()
#Across participants, there should be 40 trials in each weight x state x focus condition (8 sub x 5 trials)
exp_data %>% group_by(weight, state, focus) %>% count()
#Commenting out since not all conditions sampled
#Each item should appear in each  of 8 conditions across lists
items <- gsub('.{0,5}$', '', exp_data$object) %>% as.data.frame()
exp_data <- exp_data %>% mutate(item = items[,1] )
#exp_data %>%
#  select(item, weight, state, focus) %>% unique() %>%
#  group_by(item) %>% arrange(item) %>%
#  summarise(count = n()) %>%
#  mutate(status = case_when(
#    count < 8 ~ "item does not appear in all conditions",
#   count == 8 ~ "item appears in all conditions"
# ))
#Checking that list corresponds to condition
exp_data %>%select(condition,List) %>%unique()
#Checking that all normal/smashed pictures were labeled as such
lab_data <- exp_data %>%
mutate(check_state = str_sub(object, -5),
label = case_when(
(check_state %in% c("S.jpg","S.png") & state == "Smashed") ~ TRUE,
(check_state %in% c("N.jpg","N.png") & state == "Normal") ~ TRUE,
TRUE ~ FALSE
)) %>% select(check_state,object,label)
if (all(lab_data$label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
#Checking if weight labeled correctly
weight_data <- exp_data %>%
mutate(weight_label = case_when(
str_detect(sentence, "brick") & weight == "Heavy" ~ TRUE,
str_detect(sentence, "feather") & weight == "Light" ~ TRUE,
TRUE ~ FALSE
)) %>%
select(weight, sentence, weight_label)
if (all(weight_data$weight_label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
#Checking focus labeling
exp_data <- exp_data %>%
mutate(item = case_when(
item == "tortita" ~ "rice cake",
item == "lamp" ~ "light bulb",
item == "can" ~ "can of beer",
item == "icecream" ~ "ice cream bar",
TRUE ~ item
))
focus_data <- exp_data %>%
mutate(focus_label = case_when(
str_detect(str_remove_all(str_to_lower(str_remove_all(sentence, "[-[:space:]]")), "\\.$"),
paste0(str_to_lower(str_remove_all(item, "[-[:space:]]")), "$")) & focus == "NotFocus" ~ TRUE,
!str_detect(str_remove_all(str_to_lower(str_remove_all(sentence, "[-[:space:]]")), "\\.$"),
paste0(str_to_lower(str_remove_all(item, "[-[:space:]]")), "$")) & focus == "Focus" ~ TRUE,
TRUE ~ FALSE
)) %>%
select(item,sentence, focus, focus_label)
#Note that item/.jpg labels differed for lamp (light bulb), tortita (rice cake), beer can (can), and ice cream bar (ice cream)
if (all(focus_data$focus_label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
filler_data <- check_data %>%
filter(trialcondition=="filler") %>% filter(index!="NA")
#There should be 384 total (8 sub x 48 trials)
filler_data %>% count()
#There should be 48 trials per participant
filler_data %>% group_by(subject) %>% count()
#Should be 192 comprehension q's (24 per 8 sub)
check_data %>% filter(typeoftrial=="comprehension") %>% count()
#Should be 24 comprehension q's per sub
check_data %>% filter(typeoftrial=="comprehension") %>% group_by(subject) %>%count()
#Should be 12 yes and 12 no comp q's per subject
check_data %>% filter(typeoftrial=="comprehension") %>% group_by(subject,comprehension_type) %>%count()
demo = base %>% filter(typeoftrial %in% c("demo","english","notenglish"))
demo %>% filter(typeoftrial="english") %>%group_by(response) %>%count()
demo %>% filter(typeoftrial=="english") %>%group_by(response) %>%count()
demo_sep <- demo %>%
separate(response_variable, into = paste0("response_", seq_along(strsplit(demo$response_variable[1], ",")[[1]])), sep = ",", remove = FALSE)
demo_sep <- demo %>% filter(typeoftrial="demo")
demo_sep <- demo %>% filter(typeoftrial="demo")
demo_sep <- demo %>% filter(typeoftrial=="demo")
separate(response, into = paste0("response_", seq_along(strsplit(demo$response[1], ",")[[1]])), sep = ",", remove = FALSE)
demo_sep <- demo %>% filter(typeoftrial=="demo")
View(demo_sep)
demo_sep <- base %>% filter(typeoftrial %in% c("demo") & response != "0") %>%
separate(response, into = c("demo1", "demo2", "demo3", "demo4","demo5"), sep = ":")
demo_sep <- base %>% filter(typeoftrial %in% c("demo","english","notenglish") & response != "0") %>%
separate(response, into = c("demo1", "demo2", "demo3", "demo4","demo5"), sep = ":")
demo_sep <- base %>% filter(typeoftrial %in% c("demo","english","notenglish") & response != "0") %>%
separate(response, into = c("demo1", "demo2", "demo3", "demo4","demo5"), sep = ",")
demo_sep <- base %>% filter(typeoftrial %in% c("english","notenglish") & response != "0") %>%
separate(response, into = c("Native Speaker","AOA"), sep = ",")
demo_sep <- base %>% filter(typeoftrial %in% c("english","notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",") %>%
mutate(AOA = gsub("[^0-9]", "", AOA))
filter(AOA != "")
demo_sep <- base %>% filter(typeoftrial %in% c("english","notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",") %>%
mutate(AOA = gsub("[^0-9]", "", AOA))
filter(AOA != "")
demo_sep <- base %>% filter(typeoftrial %in% c("notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",") %>%
mutate(AOA = gsub("[^0-9]", "", AOA))
filter(AOA != "")
#Separate English AOA
demo_sep <- base %>% filter(typeoftrial %in% c("english","notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",")
#Separate English AOA
demo_sep <- base %>% filter(typeoftrial %in% c("notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",")
demo_sep <- base %>% filter(typeoftrial %in% c("notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",")%>%
mutate(AOA = gsub("[^0-9]", "", AOA)) %>%  # Keep only numeric values in AOA
filter(AOA != "")  # Remove rows where AOA is empty
demo_check<-base %>%select(age,race,gender)
View(demo_check)
#Data from second pilot - N=8
check_data <-read_csv("../data/object-state-sentence-focus_checking2.csv")
base<-check_data
#Data from second pilot - N=8
check_data <-read_csv("../data/object-state-sentence-focus_checking2.csv",fileEncoding = "UTF-8")
#Data from second pilot - N=8
check_data <-read_csv("../data/object-state-sentence-focus_checking2.csv", fileEncoding = "UTF-8")
#Data from second pilot - N=8
check_data <-read.csv("../data/object-state-sentence-focus_checking2.csv", fileEncoding = "UTF-8")
base<-check_data
#Data from second pilot - N=8
check_data <-read.csv("../data/object-state-sentence-focus_checking2.csv", fileEncoding = "UTF-8")
base<-check_data
check_data_clean <- check_data %>%
filter(!is.na(subject))
length(check_data_clean %>% pull(subject) %>% unique())
#Should be 8 participants
check_data_clean <- check_data %>%
filter(!is.na(subject))
length(check_data_clean %>% pull(subject) %>% unique())
#Should be 8 participants
prac_data <- check_data %>%
filter(trialcondition %in% c("practice_s","practice_n")) %>% filter(correct!="NA")
#Each participant should get 4 practice, 2 with yes (true) as the correct answer and 2 with no (False)
prac_data %>% group_by(subject,trialcondition) %>% count()
#Practice sentences should have 2 framed as targets ("came into contact with"), 2 framed as filler ("x is on a x")
prac_data %>% select(sentence) %>% unique()
exp_data <- check_data %>%
filter(typeoftrial=="picture" & !(trialcondition %in% c("filler", "practice_s","practice_n"))) %>%
separate(trialcondition, into = c("weight", "state","focus"))
#There should be 320 trials total (8 sub x 40)
exp_data %>% count()
#There should be 40 trials per participant
exp_data %>% group_by(subject) %>% count()
#Each participant should have 20 trials in each weight condition
exp_data %>% group_by(subject, weight) %>% count()
#Each participant should have 20 trials in each state condition
exp_data %>% group_by(subject, state) %>% count()
#Each participant should have 20 trials in each focus condition
exp_data %>% group_by(subject, focus) %>% count()
#Each participant should have 5 trials in each of 8 weight x state x focus conditions
exp_data %>% group_by(subject, weight, state, focus) %>% count()
#Across participants, there should be 40 trials in each weight x state x focus condition (8 sub x 5 trials)
exp_data %>% group_by(weight, state, focus) %>% count()
#Commenting out since not all conditions sampled
#Each item should appear in each  of 8 conditions across lists
items <- gsub('.{0,5}$', '', exp_data$object) %>% as.data.frame()
exp_data <- exp_data %>% mutate(item = items[,1] )
#exp_data %>%
#  select(item, weight, state, focus) %>% unique() %>%
#  group_by(item) %>% arrange(item) %>%
#  summarise(count = n()) %>%
#  mutate(status = case_when(
#    count < 8 ~ "item does not appear in all conditions",
#   count == 8 ~ "item appears in all conditions"
# ))
#Checking that list corresponds to condition
exp_data %>%select(condition,List) %>%unique()
#Checking that all normal/smashed pictures were labeled as such
lab_data <- exp_data %>%
mutate(check_state = str_sub(object, -5),
label = case_when(
(check_state %in% c("S.jpg","S.png") & state == "Smashed") ~ TRUE,
(check_state %in% c("N.jpg","N.png") & state == "Normal") ~ TRUE,
TRUE ~ FALSE
)) %>% select(check_state,object,label)
if (all(lab_data$label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
#Checking if weight labeled correctly
weight_data <- exp_data %>%
mutate(weight_label = case_when(
str_detect(sentence, "brick") & weight == "Heavy" ~ TRUE,
str_detect(sentence, "feather") & weight == "Light" ~ TRUE,
TRUE ~ FALSE
)) %>%
select(weight, sentence, weight_label)
if (all(weight_data$weight_label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
#Checking focus labeling
exp_data <- exp_data %>%
mutate(item = case_when(
item == "tortita" ~ "rice cake",
item == "lamp" ~ "light bulb",
item == "can" ~ "can of beer",
item == "icecream" ~ "ice cream bar",
TRUE ~ item
))
focus_data <- exp_data %>%
mutate(focus_label = case_when(
str_detect(str_remove_all(str_to_lower(str_remove_all(sentence, "[-[:space:]]")), "\\.$"),
paste0(str_to_lower(str_remove_all(item, "[-[:space:]]")), "$")) & focus == "NotFocus" ~ TRUE,
!str_detect(str_remove_all(str_to_lower(str_remove_all(sentence, "[-[:space:]]")), "\\.$"),
paste0(str_to_lower(str_remove_all(item, "[-[:space:]]")), "$")) & focus == "Focus" ~ TRUE,
TRUE ~ FALSE
)) %>%
select(item,sentence, focus, focus_label)
#Note that item/.jpg labels differed for lamp (light bulb), tortita (rice cake), beer can (can), and ice cream bar (ice cream)
if (all(focus_data$focus_label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
filler_data <- check_data %>%
filter(trialcondition=="filler") %>% filter(index!="NA")
#There should be 384 total (8 sub x 48 trials)
filler_data %>% count()
#There should be 48 trials per participant
filler_data %>% group_by(subject) %>% count()
#Should be 192 comprehension q's (24 per 8 sub)
check_data %>% filter(typeoftrial=="comprehension") %>% count()
#Should be 24 comprehension q's per sub
check_data %>% filter(typeoftrial=="comprehension") %>% group_by(subject) %>%count()
#Should be 12 yes and 12 no comp q's per subject
check_data %>% filter(typeoftrial=="comprehension") %>% group_by(subject,comprehension_type) %>%count()
demo_check<-base %>%select(age,race,gender)
demo = base %>% filter(typeoftrial %in% c("demo","english","notenglish"))
demo %>% select(age) %>%count()
demo %>% select(age)
demo %>% select(age) %>%na.omit()%>%count
demo %>% select(age)
demo %>% select(age) %>%na.omit()
demo %>% select(ID,age)
demo %>% select(Subject,age)
demo %>% select(subject,age)
demo %>% select(subject,age) %>%na.omit()
demo %>% select(subject,age) %>%na.omit() %>%count
demo %>% select(subject,gender) %>%na.omit()
#Should be 8 gender entries
demo %>% select(subject,gender) %>%na.omit() %>%count()
demo %>% select(subject,gender) %>%na.omit()
View(demo$gender)
View(demo$gender)
demo %>%select(subject, gender) %>%
filter(!is.na(gender) & gender != "") %>%
count()
demo %>%select(subject, gender) %>%
filter(!is.na(gender) & gender != "")
demo %>% select(subject,education) %>%na.omit()
demo %>% select(subject,education) %>%na.omit() %>%count()
demo %>% filter(typeoftrial=="english") %>%group_by(response) %>%count()
demo_sep <- base %>% filter(typeoftrial %in% c("notenglish")) %>%
separate(response, into = c("Not Native Speaker","AOA"), sep = ",")%>%
mutate(AOA = gsub("[^0-9]", "", AOA)) %>%  # Keep only numeric values in AOA
filter(AOA != "")  # Remove rows where AOA is empty
demo_sep %>%select(subject,AOA)
library(tidyverse)
library(ggplot2)
library (ggthemes)
library(rstatix)
library(ggpubr)
library(emmeans)
library(dplyr)
library(lmerTest)
pilot_data <- read_csv("../data/object-state-sentence-focus_checking2.csv", fileEncoding = "UTF-8")
pilot_data <- read.csv("../data/object-state-sentence-focus_checking2.csv", fileEncoding = "UTF-8")
length(pilot_data %>% pull(subject) %>% unique())
## N(final) = 10
pilot_data %>% group_by(subject) %>% count()
lang <- pilot_data %>% filter(english=="no")
pilot_data <- pilot_data %>% filter(!subject %in% lang$subject)
View(pilot_data)
##exclude filler, practice, and non-picture trials
exclusions_data <- pilot_data %>%
filter(typeoftrial=="picture" & !(trialcondition %in% c("filler", "practice_s","practice_n"))) %>%
##calculate subject accuracy
mutate(accuracy=ifelse(correct=="TRUE",1,0)) %>%
separate(trialcondition, into = c("weight", "state","focus"))
exclusions_data %>% group_by(subject, weight, state, focus) %>% count()
items <- gsub('.{0,5}$', '', exclusions_data$object) %>% as.data.frame()
exclusions_data <- exclusions_data %>% mutate(item = items[,1] )
### For experimental picture trials: this code creates a new column 'items' to id the item (picture stimulus) used in each trial. The column 'stimulus' has the picture file name and specifies the smashed/intact picture state. This new col only has the item  (ex. the original stimulus label might be "tomatoS.png" or tomatoN.png" -> new label is "tomato")
subject_accuracy <- exclusions_data %>% group_by(subject) %>% summarise(TaskAccuracy=mean(accuracy))
InaccurateSubjects <- subject_accuracy %>% filter(TaskAccuracy < 0.8)
exclusions_data %>%
group_by(weight, state,focus) %>%
summarise(ci = list(mean_cl_boot(accuracy) %>%
rename(mean=y, lwr=ymin, upr=ymax))) %>% unnest%>%
mutate(state = fct_recode(state, canonical = "Normal", `non-canonical` = "Smashed" ),
state = fct_relevel(state, "non-canonical","canonical"))%>%
ggplot(aes(x= state, y = mean, group = weight, fill = weight)) + facet_wrap(~focus)+
geom_bar(stat = "identity", position = "dodge", width = 0.7, color = "gray24")+
geom_errorbar(aes(ymin=lwr, ymax=upr), size = 0.5, width=.15,
color = "black", position = position_dodge(0.70))+
labs(y = "mean accuracy", title = "")+
theme_clean()
##exclude filler, practice, and non-picture trials
exclusions_data <- pilot_data %>%
filter(typeoftrial=="picture" & !(trialcondition %in% c("filler", "practice_s","practice_n"))) %>%
##calculate subject accuracy
mutate(accuracy=ifelse(correct=="TRUE",1,0)) %>%
separate(trialcondition, into = c("weight", "state","focus"))
exclusions_data %>% group_by(subject, weight, state, focus) %>% count()
acc_model = glmer(data = exclusions_data,
accuracy ~ state*weight*focus +
(1 + state + weight + focus|subject) + (1|stimulus),
family = "binomial",
control = glmerControl(optimizer = "bobyqa",
optCtrl=list(maxfun=200000),
check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))
summary(acc_model)
car::Anova(acc_model)
sjPlot::plot_model(acc_model, type = "int")
##exclude incorrect responses
rt_data <- exclusions_data %>% filter(accuracy==1) %>%
##exclude subjects with accuracy < 80%
filter(!subject %in% InaccurateSubjects$subject)
##total participants after exclusion: N = 113 (5 excluded)
length(rt_data %>% pull(subject) %>% unique())
##make rt numeric
rt_data <- rt_data %>% mutate(rt = as.numeric(rt))
## rt histogram ----does NOT look normally distributed (positive skew)
rt_data %>% filter(rt <10000) %>%
ggplot(aes(x=rt)) + geom_histogram(binwidth =20, fill="pink" ) +
theme_economist() + labs(x="RT (ms)", y="frequency", title= "RT histogram")
##rt log (base 10) transformation
rt_data <- rt_data %>% mutate(log10_rt=log(rt, 10))
##log10(rt) histogram
rt_data %>%
ggplot(aes(x=log10_rt)) + geom_histogram(binwidth =0.1, fill="pink" ) +
theme_economist() + labs(x="log10(rt)", y="frequency", title= "RT histogram")
mad_data = rt_data %>%
group_by(weight, state,focus) %>%
mutate(MAD=3*mad(log10_rt), med=median(log10_rt),
L= (med - MAD), U=(med + MAD)) %>%
filter(log10_rt < U) %>% filter(log10_rt > L)
(nrow(rt_data)-nrow(mad_data))/nrow(rt_data)
mad_data %>%
group_by(weight, state,focus) %>%
summarise(ci = list(mean_cl_boot(rt) %>%
rename(mean=y, lwr=ymin, upr=ymax))) %>% unnest%>%
mutate(state = fct_recode(state, canonical = "Normal", `non-canonical` = "Smashed" ),
state = fct_relevel(state, "non-canonical","canonical"))%>%
ggplot(aes(x= state, y = mean, group = weight, fill = weight)) + facet_wrap(~focus)+
geom_bar(stat = "identity", position = "dodge", width = 0.7, color = "gray24")+
geom_errorbar(aes(ymin=lwr, ymax=upr), size = 0.5, width=.15,
color = "black", position = position_dodge(0.70))+
labs(y = "RT (ms)", title = "")+
theme_clean()
rt_model = lmer(data = mad_data,
log10_rt ~ weight*state*focus +
(1 + weight+state+focus |subject) + (1|stimulus),
REML = FALSE,
lmerControl(optimizer = "bobyqa",
optCtrl=list(maxfun=200000),
check.conv.singular = .makeCC(action = "ignore",  tol = 1e-4)))
fixef(rt_model)
summary(rt_model)
car::Anova(rt_model)
library(simr)
set.seed(123)
# Change the fixed effect to be small
fixef(rt_model)["weightLight:stateSmashed:focusNotFocus"] = 0.05
# Start with an extended model up to 250 participants
extended_model <- extend(rt_model, along = "subject", n = 250)
# Perform a power curve analysis to test the three-way interaction
power_curve <- powerCurve(extended_model,
along = "subject",
fixed("weight:state:focus", "anova"),
nsim = 100)  # Number of simulations per sample size
# Plot the power curve
plot(power_curve)
prac_data <- check_data %>%
filter(trialcondition %in% c("practice_s","practice_n")) %>% filter(correct!="NA")
#Each participant should get 4 practice, 2 with yes (true) as the correct answer and 2 with no (False)
prac_data %>% group_by(subject,trialcondition) %>% count()
#Practice sentences should have 2 framed as targets ("came into contact with"), 2 framed as filler ("x is on a x")
prac_data %>% select(sentence) %>% unique()
exp_data <- check_data %>%
filter(typeoftrial=="picture" & !(trialcondition %in% c("filler", "practice_s","practice_n"))) %>%
separate(trialcondition, into = c("weight", "state","focus"))
#There should be 320 trials total (8 sub x 40)
exp_data %>% count()
#There should be 40 trials per participant
exp_data %>% group_by(subject) %>% count()
#Each participant should have 20 trials in each weight condition
exp_data %>% group_by(subject, weight) %>% count()
#Each participant should have 20 trials in each state condition
exp_data %>% group_by(subject, state) %>% count()
#Each participant should have 20 trials in each focus condition
exp_data %>% group_by(subject, focus) %>% count()
#Each participant should have 5 trials in each of 8 weight x state x focus conditions
exp_data %>% group_by(subject, weight, state, focus) %>% count()
#Across participants, there should be 40 trials in each weight x state x focus condition (8 sub x 5 trials)
exp_data %>% group_by(weight, state, focus) %>% count()
#Commenting out since not all conditions sampled
#Each item should appear in each  of 8 conditions across lists
items <- gsub('.{0,5}$', '', exp_data$object) %>% as.data.frame()
exp_data <- exp_data %>% mutate(item = items[,1] )
#exp_data %>%
#  select(item, weight, state, focus) %>% unique() %>%
#  group_by(item) %>% arrange(item) %>%
#  summarise(count = n()) %>%
#  mutate(status = case_when(
#    count < 8 ~ "item does not appear in all conditions",
#   count == 8 ~ "item appears in all conditions"
# ))
#Checking that list corresponds to condition
exp_data %>%select(condition,List) %>%unique()
#Checking that all normal/smashed pictures were labeled as such
lab_data <- exp_data %>%
mutate(check_state = str_sub(object, -5),
label = case_when(
(check_state %in% c("S.jpg","S.png") & state == "Smashed") ~ TRUE,
(check_state %in% c("N.jpg","N.png") & state == "Normal") ~ TRUE,
TRUE ~ FALSE
)) %>% select(check_state,object,label)
if (all(lab_data$label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
#Checking if weight labeled correctly
weight_data <- exp_data %>%
mutate(weight_label = case_when(
str_detect(sentence, "brick") & weight == "Heavy" ~ TRUE,
str_detect(sentence, "feather") & weight == "Light" ~ TRUE,
TRUE ~ FALSE
)) %>%
select(weight, sentence, weight_label)
if (all(weight_data$weight_label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
#Checking focus labeling
exp_data <- exp_data %>%
mutate(item = case_when(
item == "tortita" ~ "rice cake",
item == "lamp" ~ "light bulb",
item == "can" ~ "can of beer",
item == "icecream" ~ "ice cream bar",
TRUE ~ item
))
focus_data <- exp_data %>%
mutate(focus_label = case_when(
str_detect(str_remove_all(str_to_lower(str_remove_all(sentence, "[-[:space:]]")), "\\.$"),
paste0(str_to_lower(str_remove_all(item, "[-[:space:]]")), "$")) & focus == "NotFocus" ~ TRUE,
!str_detect(str_remove_all(str_to_lower(str_remove_all(sentence, "[-[:space:]]")), "\\.$"),
paste0(str_to_lower(str_remove_all(item, "[-[:space:]]")), "$")) & focus == "Focus" ~ TRUE,
TRUE ~ FALSE
)) %>%
select(item,sentence, focus, focus_label)
#Note that item/.jpg labels differed for lamp (light bulb), tortita (rice cake), beer can (can), and ice cream bar (ice cream)
if (all(focus_data$focus_label == TRUE)) {
print("all images labeled correctly")
} else {
print("Some images mislabeled")
}
